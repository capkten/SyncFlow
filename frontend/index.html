<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êñá‰ª∂ÂêåÊ≠•Âä©Êâã - ÁÆ°ÁêÜÁïåÈù¢</title>
    <meta name="description" content="Ë∑®Âπ≥Âè∞Êñá‰ª∂ÂÆûÊó∂ÂêåÊ≠•Â∑•ÂÖ∑ - Windows/Linux Êñá‰ª∂ÂêåÊ≠•ÁÆ°ÁêÜ">

    <!-- Element Plus CSS -->
    <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css">

    <!-- Ëá™ÂÆö‰πâÊ†∑Âºè -->
    <link rel="stylesheet" href="/static/css/style.css?v=2.0.0">



    <style>
        /* Âº∫Âà∂‰øÆÂ§çÂ∏ÉÂ±ÄÈóÆÈ¢òÁöÑÂÜÖËÅîÊ†∑Âºè */
        html,
        body,
        #app {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .app-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .main-container {
            display: flex;
            flex: 1;
            width: 100%;
            overflow: hidden;
        }

        .app-aside {
            height: 100%;
            width: 200px;
            flex-shrink: 0;
            overflow-y: auto;
        }

        .app-main {
            flex: 1;
            width: 0;
            min-width: 0;
            height: 100%;
            overflow: auto;
            padding: 20px;
            box-sizing: border-box;
            background-color: #f5f7fa;
        }

        /* Á°Æ‰øùÂÜÖÂÆπÂÆπÂô®ÊíëÊª° */
        .dashboard,
        .tasks,
        .logs,
        .settings {
            width: 100%;
        }

        /* Ë°®Ê†ºÂÆπÂô®ÂÖÅËÆ∏Ê∞¥Âπ≥ÊªöÂä® */
        .content-card {
            overflow-x: auto;
        }
    </style>
</head>

<body>
    <div id="app">
        <div class="app-container">
            <!-- È°∂ÈÉ®ÂØºËà™Ê†è -->
            <div class="app-header">
                <div class="header-content">
                    <h1>üìÅ Êñá‰ª∂ÂêåÊ≠•Âä©Êâã</h1>
                    <div class="header-stats">
                        <el-tag type="success">ËøêË°å‰∏≠: {{ runningCount }}</el-tag>
                        <el-tag type="info">ÊÄª‰ªªÂä°: {{ tasks.length }}</el-tag>
                        <el-tag :type="wsStatusType">{{ wsStatusText }}</el-tag>
                        <el-text size="small" type="info">{{ wsHeartbeatText }}</el-text>
                        <el-text v-if="wsReconnectHint" size="small" type="warning">{{ wsReconnectHint }}</el-text>
                    </div>
                </div>
            </div>

            <!-- ‰∏ªÂÜÖÂÆπÂå∫ -->
            <div class="main-container">
                <!-- ‰æßËæπÊ†è -->
                <div class="app-aside">
                    <el-menu :default-active="activeMenu" @select="handleMenuSelect">
                        <el-menu-item index="dashboard">
                            <el-icon>
                                <Odometer />
                            </el-icon>
                            <span>‰ª™Ë°®Áõò</span>
                        </el-menu-item>
                        <el-menu-item index="tasks">
                            <el-icon>
                                <List />
                            </el-icon>
                            <span>‰ªªÂä°ÁÆ°ÁêÜ</span>
                        </el-menu-item>
                        <el-menu-item index="logs">
                            <el-icon>
                                <Document />
                            </el-icon>
                            <span>ÂêåÊ≠•Êó•Âøó</span>
                        </el-menu-item>
                        <el-menu-item index="settings">
                            <el-icon>
                                <Setting />
                            </el-icon>
                            <span>ËÆæÁΩÆ</span>
                        </el-menu-item>
                    </el-menu>
                </div>

                <!-- ÂÜÖÂÆπÂå∫ -->
                <div class="app-main">
                    <!-- ‰ª™Ë°®Áõò -->
                    <div v-if="activeMenu === 'dashboard'" class="dashboard">
                        <h2>üìä ‰ª™Ë°®Áõò</h2>

                        <el-row :gutter="20">
                            <el-col :span="6">
                                <el-card class="stat-card">
                                    <div class="stat-number">{{ tasks.length }}</div>
                                    <div class="stat-label">ÊÄª‰ªªÂä°Êï∞</div>
                                </el-card>
                            </el-col>
                            <el-col :span="6">
                                <el-card class="stat-card success">
                                    <div class="stat-number">{{ runningCount }}</div>
                                    <div class="stat-label">ËøêË°å‰∏≠</div>
                                </el-card>
                            </el-col>
                            <el-col :span="6">
                                <el-card class="stat-card info">
                                    <div class="stat-number">{{ logStats.success || 0 }}</div>
                                    <div class="stat-label">ÊàêÂäüÂêåÊ≠•</div>
                                </el-card>
                            </el-col>
                            <el-col :span="6">
                                <el-card class="stat-card danger">
                                    <div class="stat-number">{{ logStats.failed || 0 }}</div>
                                    <div class="stat-label">ÂêåÊ≠•Â§±Ë¥•</div>
                                </el-card>
                            </el-col>
                        </el-row>

                        <el-card class="recent-logs-card">
                            <template #header>
                                <div class="card-header">
                                    <span>üìã ÊúÄËøëÂêåÊ≠•ËÆ∞ÂΩï</span>
                                    <el-button type="primary" size="small" @click="activeMenu = 'logs'">Êü•ÁúãÂÖ®ÈÉ®</el-button>
                                </div>
                            </template>
                            <!-- Ëá™ÂÆö‰πâË°®Ê†º -->
                            <div class="simple-table logs-table">
                                <div class="simple-table-header">
                                    <div class="log-col-event">‰∫ã‰ª∂</div>
                                    <div class="log-col-path">Êñá‰ª∂Ë∑ØÂæÑ</div>
                                    <div class="log-col-status">Áä∂ÊÄÅ</div>
                                    <div class="log-col-time">Êó∂Èó¥</div>
                                </div>
                                <div v-if="recentLogs.length === 0" class="simple-table-empty">
                                    ÊöÇÊó†ÂêåÊ≠•ËÆ∞ÂΩï
                                </div>
                                <div v-for="log in recentLogs" :key="log.id" class="simple-table-row">
                                    <div class="log-col-event">
                                        <el-tag :type="getEventTypeTag(log.event_type)" size="small">
                                            {{ getEventTypeName(log.event_type) }}
                                        </el-tag>
                                    </div>
                                    <div class="log-col-path" :title="log.file_path">{{ log.file_path }}</div>
                                    <div class="log-col-status">
                                        <el-tag :type="log.status === 'success' ? 'success' : 'danger'" size="small">
                                            {{ log.status === 'success' ? 'ÊàêÂäü' : 'Â§±Ë¥•' }}
                                        </el-tag>
                                    </div>
                                    <div class="log-col-time">{{ formatTime(log.sync_time) }}</div>
                                </div>
                            </div>
                        </el-card>
                    </div>

                    <!-- ‰ªªÂä°ÁÆ°ÁêÜ -->
                    <div v-if="activeMenu === 'tasks'" class="tasks">
                        <div class="page-header">
                            <h2>üìÅ ‰ªªÂä°ÁÆ°ÁêÜ</h2>
                            <div class="page-actions">
                                <el-button @click="loadTasks">
                                    <el-icon>
                                        <Refresh />
                                    </el-icon> Âà∑Êñ∞
                                </el-button>
                                <el-button type="primary" @click="showCreateDialog">
                                    <el-icon>
                                        <Plus />
                                    </el-icon> Êñ∞Âª∫‰ªªÂä°
                                </el-button>
                            </div>
                        </div>

                        <el-card class="content-card" shadow="never">
                            <div class="table-toolbar">
                                <el-input v-model="taskFilters.query" clearable placeholder="ÊêúÁ¥¢Ôºö‰ªªÂä°Âêç / Ê∫êÁõÆÂΩï / ÁõÆÊ†áË∑ØÂæÑ"
                                    style="max-width: 360px" @clear="resetTasksPage" @input="resetTasksPage">
                                    <template #prefix>
                                        <el-icon>
                                            <Search />
                                        </el-icon>
                                    </template>
                                </el-input>

                                <el-select v-model="taskFilters.targetType" clearable placeholder="Á±ªÂûã"
                                    style="width: 100px" @change="resetTasksPage"
                                    @clear="taskFilters.targetType = ''; resetTasksPage()">
                                    <el-option label="Êú¨Âú∞" value="local" />
                                    <el-option label="SSH" value="ssh" />
                                </el-select>

                                <el-select v-model="taskFilters.running" clearable placeholder="Áä∂ÊÄÅ" style="width: 100px"
                                    @change="resetTasksPage" @clear="taskFilters.running = null; resetTasksPage()">
                                    <el-option label="ËøêË°å‰∏≠" :value="true" />
                                    <el-option label="Â∑≤ÂÅúÊ≠¢" :value="false" />
                                </el-select>
                            </div>

                            <!-- ‰ΩøÁî®ÁÆÄÂçïÁöÑdivË°®Ê†ºÂ∏ÉÂ±Ä -->
                            <div class="simple-table">
                                <div class="simple-table-header">
                                    <div class="col-name">‰ªªÂä°ÂêçÁß∞</div>
                                    <div class="col-mode">Ê®°Âºè</div>
                                    <div class="col-source">Ê∫êÁõÆÂΩï</div>
                                    <div class="col-target">ÁõÆÊ†á</div>
                                    <div class="col-path">ÁõÆÊ†áË∑ØÂæÑ</div>
                                    <div class="col-status">Áä∂ÊÄÅ</div>
                                    <div class="col-actions">Êìç‰Ωú</div>
                                </div>
                                <div v-if="pagedTasks.length === 0" class="simple-table-empty">
                                    ÊöÇÊó†‰ªªÂä°ÔºåËØ∑ÁÇπÂáªÂè≥‰∏äËßí„ÄåÊñ∞Âª∫‰ªªÂä°„ÄçÂàõÂª∫
                                </div>
                                <div v-for="task in pagedTasks" :key="task.id" class="simple-table-row">
                                    <div class="col-name" :title="task.name">{{ task.name }}</div>
                                    <div class="col-mode">
                                        <el-tag :type="task.mode === 'two_way' ? 'success' : 'info'" size="small">
                                            {{ task.mode === 'two_way' ? 'ÂèåÂêë' : 'ÂçïÂêë' }}
                                        </el-tag>
                                    </div>
                                    <div class="col-source" :title="task.source_path">{{ task.source_path }}</div>
                                    <div class="col-target" :title="getTargetSummary(task)">{{ getTargetSummary(task) }}
                                    </div>
                                    <div class="col-path" :title="task.target_path">{{ task.target_path }}</div>
                                    <div class="col-status">
                                        <el-tag :type="task.is_running ? 'success' : 'info'" size="small">
                                            {{ task.is_running ? 'ËøêË°å‰∏≠' : 'Â∑≤ÂÅúÊ≠¢' }}
                                        </el-tag>
                                    </div>
                                    <div class="col-actions">
                                        <el-button v-if="!task.is_running" type="success" size="small"
                                            @click="startTask(task.id)">ÂêØÂä®</el-button>
                                        <el-button v-else type="warning" size="small"
                                            @click="stopTask(task.id)">ÂÅúÊ≠¢</el-button>
                                        <el-button type="primary" size="small"
                                            @click="syncTaskAll(task.id)">ÂÖ®Èáè</el-button>
                                        <el-button size="small" @click="openTaskDetail(task)">ËØ¶ÊÉÖ</el-button>
                                        <el-button size="small" @click="editTask(task)">ÁºñËæë</el-button>
                                        <el-button type="danger" size="small"
                                            @click="deleteTask(task.id)">Âà†Èô§</el-button>
                                    </div>
                                </div>
                            </div>

                            <div class="table-footer">
                                <el-pagination :current-page="tasksPage" :page-size="tasksPageSize"
                                    :page-sizes="[10, 20, 50, 100]" :total="filteredTasks.length"
                                    layout="total, sizes, prev, pager, next" @current-change="handleTasksPageChange"
                                    @size-change="handleTasksPageSizeChange" />
                            </div>
                        </el-card>
                    </div>

                    <!-- ÂêåÊ≠•Êó•Âøó -->
                    <div v-if="activeMenu === 'logs'" class="logs">
                        <div class="page-header">
                            <h2>üìÑ ÂêåÊ≠•Êó•Âøó</h2>
                            <div class="page-actions">
                                <el-button @click="loadLogs">
                                    <el-icon>
                                        <Refresh />
                                    </el-icon> Âà∑Êñ∞
                                </el-button>
                            </div>
                        </div>

                        <el-card class="content-card" shadow="never">
                            <div class="table-toolbar">
                                <el-select v-model="selectedLogTaskId" filterable clearable placeholder="ÈÄâÊã©‰ªªÂä°Êü•ÁúãÊó•Âøó"
                                    style="min-width: 360px" @change="handleLogTaskChange"
                                    @clear="selectedLogTaskId = null; logs = []">
                                    <el-option v-for="t in tasks" :key="t.id" :label="getTaskOptionLabel(t)"
                                        :value="t.id" />
                                </el-select>

                                <el-select v-model="logFilters.status" clearable placeholder="Áä∂ÊÄÅ" style="width: 160px"
                                    @clear="logFilters.status = ''">
                                    <el-option label="ÊàêÂäü" value="success" />
                                    <el-option label="Â§±Ë¥•" value="failed" />
                                    <el-option label="Ë∑≥Ëøá" value="skipped" />
                                </el-select>

                                <el-text type="info" size="small" v-if="selectedLogTask">
                                    ÂΩìÂâçÔºö{{ selectedLogTask.name }}Ôºà{{ selectedLogTask.source_path }} ‚Üí {{
                                    selectedLogTask.target_path }}Ôºâ
                                </el-text>
                                <el-text type="info" size="small" v-if="selectedLogTask">
                                    ‰ªÖÊòæÁ§∫ÊúÄËøë {{ logsLimit }} Êù°
                                </el-text>
                            </div>

                            <!-- ÂêåÊ≠•Êó•ÂøóËá™ÂÆö‰πâË°®Ê†º -->
                            <div class="simple-table logs-table" style="max-height: 600px; overflow-y: auto;">
                                <div class="simple-table-header">
                                    <div class="log-col-event">‰∫ã‰ª∂</div>
                                    <div class="log-col-path">Êñá‰ª∂Ë∑ØÂæÑ</div>
                                    <div class="log-col-status">Áä∂ÊÄÅ</div>
                                    <div class="log-col-error">ÈîôËØØ‰ø°ÊÅØ</div>
                                    <div class="log-col-time">Êó∂Èó¥</div>
                                </div>
                                <div v-if="!selectedLogTaskId" class="simple-table-empty">
                                    ËØ∑ÈÄâÊã©‰ªªÂä°Êü•ÁúãÊó•Âøó
                                </div>
                                <div v-else-if="filteredLogs.length === 0" class="simple-table-empty">
                                    ÊöÇÊó†Êó•Âøó
                                </div>
                                <div v-for="log in filteredLogs" :key="log.id" class="simple-table-row">
                                    <div class="log-col-event">
                                        <el-tag :type="getEventTypeTag(log.event_type)" size="small">
                                            {{ getEventTypeName(log.event_type) }}
                                        </el-tag>
                                    </div>
                                    <div class="log-col-path" :title="log.file_path">{{ log.file_path }}</div>
                                    <div class="log-col-status">
                                        <el-tag
                                            :type="log.status === 'success' ? 'success' : (log.status === 'skipped' ? 'info' : 'danger')"
                                            size="small">
                                            {{ log.status === 'success' ? 'ÊàêÂäü' : (log.status === 'skipped' ? 'Ë∑≥Ëøá' :
                                            'Â§±Ë¥•') }}
                                        </el-tag>
                                    </div>
                                    <div class="log-col-error" :title="log.error_message">{{ log.error_message || '-' }}
                                    </div>
                                    <div class="log-col-time">{{ formatTime(log.sync_time) }}</div>
                                </div>
                            </div>
                        </el-card>
                    </div>

                    <!-- ËÆæÁΩÆ -->
                    <div v-if="activeMenu === 'settings'" class="settings">
                        <h2>‚öôÔ∏è ËÆæÁΩÆ</h2>
                        <el-card style="margin-bottom: 16px">
                            <template #header>
                                <span>ËÆøÈóÆËÆ§ËØÅ</span>
                            </template>
                            <el-form label-width="120px">
                                <el-form-item label="API Token">
                                    <el-input v-model="authTokenInput" type="password" placeholder="‰ªÖ‰øùÂ≠òÂà∞ÊµèËßàÂô®Êú¨Âú∞"
                                        show-password />
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="saveAuthToken">‰øùÂ≠ò‰ª§Áâå</el-button>
                                    <el-text type="info" size="small">‰ª§Áâå‰∏ç‰ºöÂÜôÂÖ•ÈÖçÁΩÆÊñá‰ª∂</el-text>
                                </el-form-item>
                            </el-form>
                        </el-card>
                        <el-card>
                            <template #header>
                                <span>ÂÖ®Â±ÄÈÖçÁΩÆ</span>
                            </template>
                            <el-form :model="globalConfig" label-width="120px">
                                <el-form-item label="Êó•ÂøóÁ∫ßÂà´">
                                    <el-select v-model="globalConfig.log_level">
                                        <el-option label="DEBUG" value="DEBUG" />
                                        <el-option label="INFO" value="INFO" />
                                        <el-option label="WARNING" value="WARNING" />
                                        <el-option label="ERROR" value="ERROR" />
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="Web Á´ØÂè£">
                                    <el-input-number v-model="globalConfig.web_port" :min="1024" :max="65535" />
                                </el-form-item>
                                <el-form-item label="SSH ‰∏ªÊú∫Á≠ñÁï•">
                                    <el-select v-model="globalConfig.ssh_host_key_policy">
                                        <el-option label="ÊãíÁªùÊú™Áü•" value="reject" />
                                        <el-option label="Ëá™Âä®Êé•Âèó" value="auto" />
                                        <el-option label="Ë≠¶ÂëäÊ®°Âºè" value="warning" />
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="known_hosts">
                                    <el-input v-model="globalConfig.ssh_known_hosts_path" />
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="saveGlobalConfig">‰øùÂ≠òÈÖçÁΩÆ</el-button>
                                    <el-text type="info" size="small">Ê≥®ÊÑèÔºö‰øÆÊîπÁ´ØÂè£ÂêéÈúÄË¶ÅÈáçÂêØÊúçÂä°</el-text>
                                </el-form-item>
                            </el-form>
                        </el-card>
                    </div>
                </div>
            </div>
        </div>

        <!-- ÂàõÂª∫/ÁºñËæë‰ªªÂä°ÂØπËØùÊ°Ü -->
        <el-dialog v-model="taskDialogVisible" :title="isEditMode ? 'ÁºñËæë‰ªªÂä°' : 'Êñ∞Âª∫‰ªªÂä°'" width="600px">
            <el-form :model="taskForm" label-width="120px">
                <el-form-item label="‰ªªÂä°ÂêçÁß∞" required>
                    <el-input v-model="taskForm.name" placeholder="‰æãÂ¶ÇÔºöÈ°πÁõÆ‰ª£Á†ÅÂêåÊ≠•" />
                </el-form-item>
                <el-form-item label="ÂêåÊ≠•Ê®°Âºè">
                    <el-radio-group v-model="taskForm.mode" @change="handleModeChange">
                        <el-radio value="one_way">ÂçïÂêë</el-radio>
                        <el-radio value="two_way">ÂèåÂêë</el-radio>
                    </el-radio-group>
                </el-form-item>

                <template v-if="taskForm.mode === 'one_way'">
                    <el-form-item label="Ê∫êÁõÆÂΩï" required>
                        <el-input v-model="taskForm.source_path" placeholder="D:/projects/my-app" />
                    </el-form-item>
                    <el-form-item label="ÁõÆÊ†áÁ±ªÂûã" required>
                        <el-radio-group v-model="taskForm.target_type">
                            <el-radio value="local">Êú¨Âú∞</el-radio>
                            <el-radio value="ssh">SSH ËøúÁ®ã</el-radio>
                        </el-radio-group>
                    </el-form-item>

                    <template v-if="taskForm.target_type === 'ssh'">
                        <el-form-item label="‰∏ªÊú∫Âú∞ÂùÄ" required>
                            <el-input v-model="taskForm.target_host" placeholder="192.168.1.100" />
                        </el-form-item>
                        <el-form-item label="Á´ØÂè£">
                            <el-input-number v-model="taskForm.target_port" :min="1" :max="65535" />
                        </el-form-item>
                        <el-form-item label="Áî®Êà∑Âêç" required>
                            <el-input v-model="taskForm.target_username" placeholder="user" />
                        </el-form-item>
                        <el-form-item label="ÂØÜÁ†Å">
                            <el-input v-model="taskForm.target_password" type="password" placeholder="ÁïôÁ©∫‰ΩøÁî® SSH ÂØÜÈí•" />
                        </el-form-item>
                        <el-form-item label="SSH ÂØÜÈí•Ë∑ØÂæÑ">
                            <el-input v-model="taskForm.target_ssh_key_path" placeholder="/path/to/id_rsa" />
                        </el-form-item>
                    </template>

                    <el-form-item label="ÁõÆÊ†áË∑ØÂæÑ" required>
                        <el-input v-model="taskForm.target_path" placeholder="E:/backup Êàñ /home/user/my-app" />
                    </el-form-item>
                </template>

                <template v-else>
                    <el-divider>Á´ØÁÇπ A</el-divider>
                    <el-form-item label="Á´ØÁÇπAÁ±ªÂûã" required>
                        <el-radio-group v-model="taskForm.endpoint_a.type">
                            <el-radio value="local">Êú¨Âú∞</el-radio>
                            <el-radio value="ssh">SSH ËøúÁ®ã</el-radio>
                        </el-radio-group>
                    </el-form-item>
                    <el-form-item label="Á´ØÁÇπAË∑ØÂæÑ" required>
                        <el-input v-model="taskForm.endpoint_a.path" placeholder="D:/projects/my-app" />
                    </el-form-item>
                    <template v-if="taskForm.endpoint_a.type === 'ssh'">
                        <el-form-item label="‰∏ªÊú∫Âú∞ÂùÄ" required>
                            <el-input v-model="taskForm.endpoint_a.host" placeholder="192.168.1.100" />
                        </el-form-item>
                        <el-form-item label="Á´ØÂè£">
                            <el-input-number v-model="taskForm.endpoint_a.port" :min="1" :max="65535" />
                        </el-form-item>
                        <el-form-item label="Áî®Êà∑Âêç" required>
                            <el-input v-model="taskForm.endpoint_a.username" placeholder="user" />
                        </el-form-item>
                        <el-form-item label="ÂØÜÁ†Å">
                            <el-input v-model="taskForm.endpoint_a.password" type="password"
                                placeholder="ÁïôÁ©∫‰ΩøÁî® SSH ÂØÜÈí•" />
                        </el-form-item>
                        <el-form-item label="SSH ÂØÜÈí•Ë∑ØÂæÑ">
                            <el-input v-model="taskForm.endpoint_a.ssh_key_path" placeholder="/path/to/id_rsa" />
                        </el-form-item>
                    </template>

                    <el-divider>Á´ØÁÇπ B</el-divider>
                    <el-form-item label="Á´ØÁÇπBÁ±ªÂûã" required>
                        <el-radio-group v-model="taskForm.endpoint_b.type">
                            <el-radio value="local">Êú¨Âú∞</el-radio>
                            <el-radio value="ssh">SSH ËøúÁ®ã</el-radio>
                        </el-radio-group>
                    </el-form-item>
                    <el-form-item label="Á´ØÁÇπBË∑ØÂæÑ" required>
                        <el-input v-model="taskForm.endpoint_b.path" placeholder="E:/backup Êàñ /home/user/my-app" />
                    </el-form-item>
                    <template v-if="taskForm.endpoint_b.type === 'ssh'">
                        <el-form-item label="‰∏ªÊú∫Âú∞ÂùÄ" required>
                            <el-input v-model="taskForm.endpoint_b.host" placeholder="192.168.1.100" />
                        </el-form-item>
                        <el-form-item label="Á´ØÂè£">
                            <el-input-number v-model="taskForm.endpoint_b.port" :min="1" :max="65535" />
                        </el-form-item>
                        <el-form-item label="Áî®Êà∑Âêç" required>
                            <el-input v-model="taskForm.endpoint_b.username" placeholder="user" />
                        </el-form-item>
                        <el-form-item label="ÂØÜÁ†Å">
                            <el-input v-model="taskForm.endpoint_b.password" type="password"
                                placeholder="ÁïôÁ©∫‰ΩøÁî® SSH ÂØÜÈí•" />
                        </el-form-item>
                        <el-form-item label="SSH ÂØÜÈí•Ë∑ØÂæÑ">
                            <el-input v-model="taskForm.endpoint_b.ssh_key_path" placeholder="/path/to/id_rsa" />
                        </el-form-item>
                    </template>
                </template>
                <el-form-item label="Êç¢Ë°åÁ¨¶Â§ÑÁêÜ">
                    <el-radio-group v-model="taskForm.eol_normalize">
                        <el-radio value="lf">LF (Unix)</el-radio>
                        <el-radio value="crlf">CRLF (Windows)</el-radio>
                        <el-radio value="keep">‰øùÊåÅÂéüÊ†∑</el-radio>
                    </el-radio-group>
                </el-form-item>
                <el-form-item label="ÊéíÈô§ËßÑÂàô">
                    <el-input v-model="excludePatternsText" type="textarea" :rows="3"
                        placeholder="ÊØèË°å‰∏Ä‰∏™ËßÑÂàôÔºå‰æãÂ¶ÇÔºö&#10;*.pyc&#10;__pycache__&#10;.git" />
                </el-form-item>
                <el-form-item label="ÂêØÁî®‰ªªÂä°">
                    <el-switch v-model="taskForm.enabled" />
                </el-form-item>
                <el-form-item label="Ëá™Âä®ÂêØÂä®">
                    <el-switch v-model="taskForm.auto_start" />
                </el-form-item>
                <el-form-item label="SSH ËΩÆËØ¢Èó¥Èöî(Áßí)"
                    v-if="taskForm.mode === 'two_way' && (taskForm.endpoint_a.type === 'ssh' || taskForm.endpoint_b.type === 'ssh')">
                    <el-input-number v-model="taskForm.poll_interval_seconds" :min="1" :max="300" />
                    <el-text type="info" size="small" style="margin-left: 8px">‰ªÖÂØπ SSH Á´ØÊúâÊïà</el-text>
                </el-form-item>
                <el-form-item label="ÂõûÊî∂Á´ô‰øùÁïô(Â§©)">
                    <el-input-number v-model="taskForm.trash_retention_days" :min="0" :max="3650" />
                    <el-text type="info" size="small" style="margin-left: 8px">0 Ë°®Á§∫‰∏çÊ∏ÖÁêÜ</el-text>
                </el-form-item>
                <el-form-item label="Â§á‰ªΩ‰øùÁïô(Â§©)">
                    <el-input-number v-model="taskForm.backup_retention_days" :min="0" :max="3650" />
                    <el-text type="info" size="small" style="margin-left: 8px">0 Ë°®Á§∫‰∏çÊ∏ÖÁêÜ</el-text>
                </el-form-item>
            </el-form>
            <template #footer>
                <el-button @click="taskDialogVisible = false">ÂèñÊ∂à</el-button>
                <el-button type="primary" @click="saveTask">‰øùÂ≠ò</el-button>
            </template>
        </el-dialog>

        <!-- ‰ªªÂä°ËØ¶ÊÉÖ -->
        <el-drawer v-model="taskDetailVisible" title="‰ªªÂä°ËØ¶ÊÉÖ" size="520px">
            <template v-if="taskDetail">
                <el-descriptions :column="1" border>
                    <el-descriptions-item label="‰ªªÂä°ÂêçÁß∞">{{ taskDetail.name || '-' }}</el-descriptions-item>
                    <el-descriptions-item label="ÂêåÊ≠•Ê®°Âºè">
                        {{ taskDetail.mode === 'two_way' ? 'ÂèåÂêë' : 'ÂçïÂêë' }}
                    </el-descriptions-item>
                    <el-descriptions-item label="Ê∫êÁõÆÂΩï">{{ taskDetail.source_path || '-' }}</el-descriptions-item>
                    <el-descriptions-item label="ÁõÆÊ†áÁ±ªÂûã">{{ taskDetail.target_type || '-' }}</el-descriptions-item>
                    <el-descriptions-item label="ÁõÆÊ†á">{{ getTargetSummary(taskDetail) }}</el-descriptions-item>
                    <el-descriptions-item label="ÁõÆÊ†áË∑ØÂæÑ">{{ taskDetail.target_path || '-' }}</el-descriptions-item>
                    <el-descriptions-item v-if="taskDetail.endpoints" label="Á´ØÁÇπA">
                        {{ getEndpointSummary(taskDetail, 'a') }}
                    </el-descriptions-item>
                    <el-descriptions-item v-if="taskDetail.endpoints" label="Á´ØÁÇπB">
                        {{ getEndpointSummary(taskDetail, 'b') }}
                    </el-descriptions-item>
                    <el-descriptions-item label="Êç¢Ë°åÁ¨¶">{{ getEolLabel(taskDetail.eol_normalize) }}</el-descriptions-item>
                    <el-descriptions-item label="ÂêØÁî®">{{ taskDetail.enabled ? 'ÊòØ' : 'Âê¶' }}</el-descriptions-item>
                    <el-descriptions-item label="Ëá™Âä®ÂêØÂä®">{{ taskDetail.auto_start ? 'ÊòØ' : 'Âê¶' }}</el-descriptions-item>
                    <el-descriptions-item label="ÂõûÊî∂Á´ô‰øùÁïô">
                        {{ taskDetail.trash_retention_days ?? 7 }} Â§©
                    </el-descriptions-item>
                    <el-descriptions-item v-if="taskDetail.mode === 'two_way'" label="SSH ËΩÆËØ¢Èó¥Èöî">
                        {{ taskDetail.poll_interval_seconds ?? 5 }} Áßí
                    </el-descriptions-item>
                    <el-descriptions-item label="Â§á‰ªΩ‰øùÁïô">
                        {{ taskDetail.backup_retention_days ?? 7 }} Â§©
                    </el-descriptions-item>
                    <el-descriptions-item label="ÊéíÈô§ËßÑÂàô">
                        <el-text v-if="(taskDetail.exclude_patterns || []).length" style="white-space: pre-wrap">
                            {{ (taskDetail.exclude_patterns || []).join('\n') }}
                        </el-text>
                        <el-text v-else type="info">-</el-text>
                    </el-descriptions-item>
                    <el-descriptions-item label="ÂêåÊ≠•Êñá‰ª∂Á±ªÂûã">
                        <el-text v-if="(taskDetail.file_extensions || []).length">
                            {{ (taskDetail.file_extensions || []).join(', ') }}
                        </el-text>
                        <el-text v-else type="info">ÂÖ®ÈÉ®</el-text>
                    </el-descriptions-item>
                </el-descriptions>
            </template>
        </el-drawer>
    </div>

    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Element Plus -->
    <script src="https://unpkg.com/element-plus"></script>
    <!-- Element Plus Icons -->
    <script src="https://unpkg.com/@element-plus/icons-vue/dist/index.iife.min.js"></script>

    <!-- Â∫îÁî®ËÑöÊú¨ -->
    <script src="/static/js/app.js?v=2.0.0"></script>
</body>

</html>